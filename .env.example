# =============================================================================
# Simple IdP Configuration
# =============================================================================
# Copy this file to .env and customize for your environment.
# All variables are optional and have sensible defaults.

# -----------------------------------------------------------------------------
# Server Settings
# -----------------------------------------------------------------------------
IDP_HOST=0.0.0.0
IDP_PORT=8080
IDP_ISSUER_URL=http://localhost:8080

# -----------------------------------------------------------------------------
# Storage
# -----------------------------------------------------------------------------
IDP_DATA_DIR=./data

# -----------------------------------------------------------------------------
# Session Settings
# -----------------------------------------------------------------------------
IDP_SESSION_DURATION=24h
IDP_COOKIE_SECRET=           # Auto-generated if empty (set for production!)
IDP_COOKIE_SECURE=false      # Set to true when using HTTPS
IDP_COOKIE_DOMAIN=           # Leave empty for current domain

# -----------------------------------------------------------------------------
# Token Settings
# -----------------------------------------------------------------------------
IDP_ACCESS_TOKEN_TTL=15m
IDP_REFRESH_TOKEN_TTL=168h   # 7 days
IDP_AUTH_CODE_TTL=10m

# -----------------------------------------------------------------------------
# Key Rotation
# -----------------------------------------------------------------------------
IDP_SIGNING_KEY_ROTATION_DAYS=30

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
IDP_LOGIN_RATE_LIMIT=5       # Login attempts per minute per IP (0 = disabled)

# -----------------------------------------------------------------------------
# Account Lockout
# -----------------------------------------------------------------------------
IDP_LOCKOUT_MAX_ATTEMPTS=5   # Failed attempts before lockout (0 = disabled)
IDP_LOCKOUT_DURATION=15m     # How long account stays locked

# -----------------------------------------------------------------------------
# CORS (Cross-Origin Resource Sharing)
# -----------------------------------------------------------------------------
# Comma-separated list of allowed origins. Leave empty to disable CORS.
IDP_CORS_ALLOWED_ORIGINS=
# Example: IDP_CORS_ALLOWED_ORIGINS=https://app.example.com,https://admin.example.com
IDP_CORS_ALLOW_CREDENTIALS=true

# -----------------------------------------------------------------------------
# Security Headers
# -----------------------------------------------------------------------------
IDP_SECURITY_HEADERS_ENABLED=true
IDP_CONTENT_SECURITY_POLICY=default-src 'self'; style-src 'self' 'unsafe-inline'; frame-ancestors 'none'
IDP_HSTS_MAX_AGE=0           # 0 = disabled, 31536000 = 1 year (recommended for HTTPS)

# -----------------------------------------------------------------------------
# Metrics (Prometheus)
# -----------------------------------------------------------------------------
IDP_METRICS_ENABLED=true     # Exposes /metrics endpoint

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
IDP_LOG_LEVEL=info           # debug, info, warn, error
IDP_LOG_FORMAT=json          # json or text

# -----------------------------------------------------------------------------
# Client Configuration (Simple - Single Client)
# -----------------------------------------------------------------------------
# Use these for a single OAuth client. Takes precedence over IDP_BOOTSTRAP_CLIENTS.
IDP_CLIENT_ID=my-app
IDP_CLIENT_SECRET=my-secret  # Leave empty for public clients (PKCE required)
IDP_CLIENT_REDIRECT_URI=http://localhost:3000/callback
# Multiple redirect URIs: IDP_CLIENT_REDIRECT_URI=http://localhost:3000/callback http://localhost:3000/silent

# -----------------------------------------------------------------------------
# Client Configuration (Advanced - Multiple Clients)
# -----------------------------------------------------------------------------
# Format: client_id|secret|redirect_uri (comma-separated for multiple clients)
# Empty secret for public clients: public-app||http://localhost:3000/callback
# Multiple redirect URIs: app|secret|http://uri1 http://uri2
# IDP_BOOTSTRAP_CLIENTS=app1|secret1|http://localhost:3000/callback,app2||http://localhost:4000/callback

# -----------------------------------------------------------------------------
# Bootstrap Users
# -----------------------------------------------------------------------------
# Format: email:password:name (comma-separated for multiple users)
IDP_BOOTSTRAP_USERS=test@example.com:password123:Test User
# Example: IDP_BOOTSTRAP_USERS=admin@example.com:admin123:Admin,user@example.com:user123:User
